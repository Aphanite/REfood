<!--  <span class="check1"><i class="fa fa-check"></i></span> -->
<body style="background: #eaf9ec;">
    <div class="order-container">
      <div class="order__header" style="font-size: 28px;">Choose your pickup slot</div>

      <% grouped_session = session[:cart].group_by { |p| p["supermarketId"].itself } %>
      <% grouped_session.each do  |group| %>
        <%= Supermarket.find(group[0]).name %>
        <% dates = group[1].map do |item| %>
          <% Product.find(item["productId"]).best_before_date %>
        <% end %>
        <%= dates %>
        <%= dates.min %>
      <% end %>
<!--
      <form action="/orders" method="POST" id="pickup-container">
        <div>
          <label for="pickup-date">Date</label>
          <input name="pickup-date" id="pickup-date" value="" placeholder="Add pickup date">
        </div>
        <div>
          <label for="pickup-time">Time</label>
          <input name="pickup-time" id="pickup-time" value="" placeholder="Add pickup time">
        </div>
        <div>
          <button>Go to payment</button>
        </div> -->
<!--       </form> -->

      <%= simple_form_for :order, url: orders_path, html: { id: :pickupContainer } do |f| %>
        <%= f.label :pickupDate, "Date" %>
        <%= f.input :pickupDate, as: :string, required: false, input_html: { id: "pickupDate" } %>
      <% end %>

       <!-- initialize total price and discount -->
      <% total_price = 0 %>
      <% discount = 0 %>
      <div class="order__content">
        <% session[:cart].each do |item| %>
          <% product = Product.find(item["productId"]) %>
          <!-- increment total price and discount by the amount spent/saved for current product -->
          <% total_price += product.discounted_price * item["offset"]%>
          <% discount += (product.full_price - product.discounted_price) * item["offset"]%>
        <% end %>
      </div>

      <div class="order__checkout" style="background: #eaf9ec;">
        <hr style="border: 0.5px solid #000000;">
        <div class="p-1">
          <div class="d-flex justify-content-between mt-2">
            <h5 style="font-weight: bold; font-size: 22px;">Total</h5>
            <h5 style="font-weight: bold; font-size: 22px;"><%= humanized_money_with_symbol(total_price) %></h5>
          </div>
          <div class="d-flex justify-content-between">
            <h5>You save!</h5>
            <h5><%= humanized_money_with_symbol(discount) %></h5>
          </div>
          <div class="d-flex justify-content-between">
            <h5 style="color: #079145;">You gain!</h5>
            <h5 style="color: #079145;">5 points</h5>
          </div>
        </div>
        <div class="d-flex justify-content-center">
  <!--         <button class="btn-gradient">Go to checkout</button> -->
          <%= link_to "Go to checkout", confirm_path, class: "btn-gradient" %>
        </div>
      </div>
  </div>


</body>
